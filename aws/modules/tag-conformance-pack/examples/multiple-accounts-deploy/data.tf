data "aws_iam_policy_document" "script_policy" {
  statement {
    sid     = "TagRemediationAutomationPolicy"
    effect  = "Allow"
    actions = [
      "config:GetComplianceDetailsByConfigRule",
      "config:GetComplianceDetailsByResource",
      "config:PutEvaluations",
      "config:PutExternalEvaluation",
      "config:TagResource",
      "config:GetConformancePackComplianceDetails",
      "config:DescribeConformancePacks",
      "config:BatchGetResourceConfig",
      "tag:getResources",
      "tag:getTagKeys",
      "tag:getTagValues",
      "tag:TagResources",
      "redshift:CreateTags",
      "elasticmapreduce:AddTags",
      "osis:TagResource",
      "aoss:TagResource",
      "es:AddTags",
      "redshift-serverless:TagResource",
      "ecr:TagResource",
      "emr-containers:TagResource",
      "ecr-public:TagResource",
      "ecs:TagResource",
      "imagebuilder:TagResource",
      "rds:AddTagsToResource",
      "mq:CreateTags",
      "eks:TagResource",
      "ec2:CreateTags",
      "s3:PutObjectVersionTagging",
      "s3:PutObjectTagging",
      "s3:PutBucketTagging",
      "s3:TagResource",
      "s3:PutStorageLensConfigurationTagging",
      "s3:PutJobTagging",
      "iam:TagUser",
      "iam:TagServerCertificate",
      "iam:TagSAMLProvider",
      "iam:TagRole",
      "iam:TagPolicy",
      "iam:TagOpenIDConnectProvider",
      "iam:TagMFADevice",
      "iam:TagInstanceProfile",
      "iam:GetRole",
      "iam:GetInstanceProfile",
      "iam:ListRoleTags",
      "iam:GetPolicy",
      "iam:ListGroupPolicies",
      "iam:ListInstanceProfileTags",
      "iam:ListUserPolicies",
      "iam:GetGroup",
      "iam:ListInstanceProfilesForRole",
      "iam:GetUserPolicy",
      "iam:ListGroupsForUser",
      "iam:ListAttachedRolePolicies",
      "iam:ListServerCertificateTags",
      "iam:ListSAMLProviderTags",
      "iam:ListAttachedUserPolicies",
      "iam:GetGroupPolicy",
      "iam:ListPolicyTags",
      "iam:GetUser",
      "iam:ListRolePolicies",
      "iam:GetOpenIDConnectProvider",
      "iam:ListMFADeviceTags",
      "iam:GetRolePolicy",
      "iam:GetSAMLProvider",
      "iam:ListUserTags",
      "application-autoscaling:TagResource",
      "autoscaling:CreateOrUpdateTags",
      "lambda:TagResource",
      "sns:TagResource",
      "sqs:TagQueue",
      "elasticloadbalancing:AddTags",
      "elasticache:AddTagsToResource",
      "elasticache:ListTagsForResource",
      "elasticache:DescribeCacheClusters",
      "secretsmanager:TagResource",
      "events:ListTagsForResource",
      "events:TagResource",
      "events:ListEventBuses",
      "events:ListRules",
      "ssm:DescribeParameters",
      "ssm:ListTagsForResource",
      "ssm:AddTagsToResource",
      "ssm:GetParameter",
      "ssm:GetParameters",
      "config:ListTagsForResource",
      "config:DescribeConfigRules",
      "logs:ListTagsLogGroup",
      "logs:ListTagsForResource",
      "logs:TagLogGroup",
      "logs:TagResource",
      "logs:DescribeLogGroups",
      "cloudwatch:TagResource",
      "cloudwatch:ListTagsForResource",
      "cloudwatch:DescribeAlarms",
      "athena:ListTagsForResource",
      "athena:TagResource",
      "athena:ListDatabases",
      "backup:ListTags",
      "backup:TagResource",
      "backup:ListBackupVaults",
      "backup:ListBackupSelections",
      "backup:ListBackupPlanVersions",
      "backup:ListBackupPlanTemplates",
      "backup:ListBackupPlans",
      "backup:ListBackupJobSummaries",
      "backup:ListBackupJobs",
      "secretsmanager:TagResource",
      "secretsmanager:ListSecrets",
      "secretsmanager:DescribeSecret"
    ]
    resources = ["*"]
  }
}
